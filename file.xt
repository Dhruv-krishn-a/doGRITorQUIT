<!DOCTYPE html>
<html lang="en" class="lenis lenis-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Protocol: DEV_X</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;500;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/studio-freight/lenis@1.0.29/bundled/lenis.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        :root {
            --bg: #050505;
            --primary: #00f0ff;
            --secondary: #7000ff;
            --grid-color: rgba(0, 240, 255, 0.1);
        }

        body {
            background-color: var(--bg);
            color: white;
            font-family: 'Space Grotesk', sans-serif;
            margin: 0;
            overflow-x: hidden;
            cursor: none; /* Custom cursor */
        }

        /* --- CUSTOM CURSOR --- */
        #cursor {
            position: fixed;
            top: 0;
            left: 0;
            width: 20px;
            height: 20px;
            border: 2px solid var(--primary);
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            transform: translate(-50%, -50%);
            mix-blend-mode: difference;
            transition: width 0.3s, height 0.3s, background-color 0.3s;
        }
        
        #cursor-dot {
            position: fixed;
            top: 0;
            left: 0;
            width: 4px;
            height: 4px;
            background: white;
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            transform: translate(-50%, -50%);
        }

        body.hovering #cursor {
            width: 50px;
            height: 50px;
            background-color: rgba(0, 240, 255, 0.1);
            border-color: transparent;
        }

        /* --- RETRO GRID BACKGROUND --- */
        .retro-grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -2;
            perspective: 1000px;
            overflow: hidden;
        }
        .grid-plane {
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background-image: 
                linear-gradient(var(--grid-color) 1px, transparent 1px),
                linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
            background-size: 50px 50px;
            transform: rotateX(60deg);
            animation: gridMove 20s linear infinite;
        }

        @keyframes gridMove {
            0% { transform: rotateX(60deg) translateY(0); }
            100% { transform: rotateX(60deg) translateY(50px); }
        }

        /* --- UTILS --- */
        .mono { font-family: 'JetBrains Mono', monospace; }
        
        .glitch-text {
            position: relative;
        }
        
        /* Glass Panel */
        .glass-panel {
            background: rgba(10, 10, 15, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            box-shadow: 0 0 30px rgba(0, 240, 255, 0.05);
            transition: all 0.4s ease;
        }
        
        .glass-panel:hover {
            border-color: rgba(0, 240, 255, 0.4);
            box-shadow: 0 0 50px rgba(0, 240, 255, 0.15);
            transform: translateY(-5px);
        }

        /* --- ISOMETRIC CANVAS --- */
        .iso-container {
            width: 100%;
            height: 300px;
            position: relative;
            overflow: hidden;
        }

        /* --- SCROLLBAR --- */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg); }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
        
        /* --- LOADER --- */
        #loader {
            position: fixed;
            inset: 0;
            background: #000;
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
    </style>
</head>
<body>

    <!-- CUSTOM CURSOR -->
    <div id="cursor"></div>
    <div id="cursor-dot"></div>

    <!-- LOADER -->
    <div id="loader">
        <div class="mono text-2xl text-[var(--primary)] mb-4">INITIALIZING SYSTEM</div>
        <div class="w-64 h-1 bg-gray-900 rounded overflow-hidden">
            <div class="h-full bg-[var(--primary)] w-0" id="loader-bar"></div>
        </div>
    </div>

    <!-- BACKGROUND -->
    <div class="retro-grid">
        <div class="grid-plane"></div>
        <div class="absolute inset-0 bg-gradient-to-t from-[var(--bg)] via-transparent to-transparent z-10"></div>
    </div>

    <!-- CONTENT -->
    <main>
        
        <!-- NAV -->
        <nav class="fixed top-0 w-full p-8 flex justify-between items-center z-50 mix-blend-exclusion">
            <div class="text-xl font-bold tracking-widest mono cursor-target">DEV_X</div>
            <div class="mono text-xs text-[var(--primary)] animate-pulse">
                STATUS: SECURE
            </div>
        </nav>

        <!-- HERO -->
        <section class="h-screen flex flex-col justify-center items-center relative px-6">
            
            <div class="relative z-10 text-center">
                <div class="mono text-[var(--primary)] text-sm mb-4 opacity-0 reveal-item">Subject: Portfolio</div>
                <h1 class="text-6xl md:text-9xl font-bold leading-none mb-6 cursor-target" id="hero-title" data-value="ARCHITECT">
                    ARCHITECT
                </h1>
                <p class="text-gray-400 max-w-lg mx-auto text-lg md:text-xl opacity-0 reveal-item">
                    Constructing digital reality through clean code and complex systems.
                </p>
            </div>

            <div class="absolute bottom-12 flex flex-col items-center opacity-0 reveal-item">
                <div class="w-[1px] h-24 bg-gradient-to-b from-[var(--primary)] to-transparent"></div>
                <span class="mono text-xs mt-4 text-gray-500">SCROLL TO ACCESS DATA</span>
            </div>
        </section>

        <!-- GIT CITY SECTION -->
        <section class="min-h-screen py-32 px-6 md:px-20 relative z-10">
            
            <div class="max-w-7xl mx-auto">
                
                <div class="flex flex-col md:flex-row justify-between items-end mb-16 border-b border-gray-800 pb-8">
                    <div>
                        <h2 class="text-5xl md:text-6xl font-bold mb-2 cursor-target hacker-text" data-value="GIT_METRICS">GIT_METRICS</h2>
                        <p class="mono text-[var(--primary)] text-sm">Visualizing contribution data density</p>
                    </div>
                    <div class="mono text-right hidden md:block">
                        <div class="text-xs text-gray-500">LAST SYNC</div>
                        <div>2025.12.10</div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                    
                    <!-- LEFT: THE CITY (CANVAS) -->
                    <div class="lg:col-span-8">
                        <div class="glass-panel p-1 md:p-6 h-full relative group cursor-target">
                            <div class="absolute top-6 left-6 z-20">
                                <h3 class="text-xl font-bold">Contribution City</h3>
                                <span class="mono text-xs text-gray-400">Isometric View</span>
                            </div>
                            
                            <!-- The Canvas -->
                            <div class="iso-container w-full h-[400px] md:h-[500px]">
                                <canvas id="city-canvas"></canvas>
                            </div>

                            <!-- Overlay details -->
                            <div class="absolute bottom-6 left-6 z-20 mono text-xs text-[var(--primary)]">
                                RENDER_ENGINE: CANVAS_2D<br>
                                PROJECTION: ISOMETRIC
                            </div>
                        </div>
                    </div>

                    <!-- RIGHT: DATA STREAM -->
                    <div class="lg:col-span-4 flex flex-col gap-6">
                        
                        <!-- Stat Box -->
                        <div class="glass-panel p-8 cursor-target">
                            <div class="mono text-xs text-gray-500 mb-2">TOTAL COMMITS</div>
                            <div class="text-5xl font-bold text-white counter" data-target="4829">0</div>
                            <div class="h-1 w-full bg-gray-800 mt-4 rounded-full overflow-hidden">
                                <div class="h-full bg-[var(--primary)] w-[80%]"></div>
                            </div>
                        </div>

                        <!-- Stat Box -->
                        <div class="glass-panel p-8 cursor-target">
                            <div class="mono text-xs text-gray-500 mb-2">CURRENT STREAK</div>
                            <div class="flex items-baseline gap-2">
                                <div class="text-5xl font-bold text-[var(--secondary)] counter" data-target="24">0</div>
                                <span class="text-sm">days</span>
                            </div>
                        </div>

                        <!-- Terminal Log -->
                        <div class="glass-panel flex-1 p-6 overflow-hidden flex flex-col min-h-[300px]">
                            <div class="flex items-center gap-2 mb-4 border-b border-gray-800 pb-2">
                                <div class="w-2 h-2 rounded-full bg-[var(--primary)] animate-pulse"></div>
                                <span class="mono text-xs text-gray-400">LIVE LOG</span>
                            </div>
                            <div class="mono text-xs space-y-3 text-gray-400 overflow-y-auto" id="terminal-logs">
                                <!-- JS Injected Logs -->
                            </div>
                        </div>

                    </div>

                </div>
            </div>
        </section>

        <!-- FOOTER -->
        <footer class="py-20 text-center border-t border-gray-900">
            <h2 class="text-[10vw] font-bold text-[#111] select-none">SYSTEM_OFF</h2>
        </footer>

    </main>

    <script>
        // --- 1. SMOOTH SCROLL (LENIS) ---
        const lenis = new Lenis({
            duration: 1.2,
            easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
            direction: 'vertical',
            gestureDirection: 'vertical',
            smooth: true,
            mouseMultiplier: 1,
            smoothTouch: false,
            touchMultiplier: 2,
        });

        function raf(time) {
            lenis.raf(time);
            requestAnimationFrame(raf);
        }
        requestAnimationFrame(raf);


        // --- 2. CUSTOM CURSOR ---
        const cursor = document.getElementById('cursor');
        const cursorDot = document.getElementById('cursor-dot');
        
        window.addEventListener('mousemove', (e) => {
            gsap.to(cursor, { x: e.clientX, y: e.clientY, duration: 0.1, ease: 'power2.out' });
            gsap.to(cursorDot, { x: e.clientX, y: e.clientY, duration: 0, ease: 'power2.out' });
        });

        // Hover Effect
        document.querySelectorAll('.cursor-target').forEach(el => {
            el.addEventListener('mouseenter', () => document.body.classList.add('hovering'));
            el.addEventListener('mouseleave', () => document.body.classList.remove('hovering'));
        });


        // --- 3. LOADER & REVEAL ---
        const loaderBar = document.getElementById('loader-bar');
        const loader = document.getElementById('loader');

        // Simulate load
        gsap.to(loaderBar, {
            width: "100%",
            duration: 1.5,
            ease: "power2.inOut",
            onComplete: () => {
                gsap.to(loader, {
                    yPercent: -100,
                    duration: 1,
                    ease: "power4.inOut",
                    onComplete: startHeroAnimations
                });
            }
        });

        function startHeroAnimations() {
            // Hacker Text Effect for Hero
            const heroTitle = document.getElementById('hero-title');
            hackTextEffect(heroTitle);

            gsap.to('.reveal-item', {
                y: 0,
                opacity: 1,
                duration: 1,
                stagger: 0.2,
                ease: "power3.out",
                delay: 0.5
            });
        }

        // --- 4. HACKER TEXT EFFECT UTILITY ---
        const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%&";
        
        function hackTextEffect(element) {
            let iterations = 0;
            const originalText = element.dataset.value;
            
            const interval = setInterval(() => {
                element.innerText = originalText.split("")
                    .map((letter, index) => {
                        if(index < iterations) return originalText[index];
                        return letters[Math.floor(Math.random() * 26)];
                    })
                    .join("");
                
                if(iterations >= originalText.length) clearInterval(interval);
                iterations += 1/3;
            }, 30);
        }

        // Apply to section headers on scroll
        gsap.utils.toArray('.hacker-text').forEach(text => {
            ScrollTrigger.create({
                trigger: text,
                start: "top 80%",
                onEnter: () => hackTextEffect(text)
            });
        });


        // --- 5. ISOMETRIC CITY CANVAS (The "Wow" Factor) ---
        const canvas = document.getElementById('city-canvas');
        const ctx = canvas.getContext('2d');
        let cityWidth, cityHeight;
        
        // Configuration
        const tileW = 24; // Width of tile
        const tileH = 12; // Height of tile (half width for iso)
        const gridRows = 14; 
        const gridCols = 14;
        let mapData = [];
        let time = 0;

        function resizeCanvas() {
            const parent = canvas.parentElement;
            cityWidth = parent.clientWidth;
            cityHeight = parent.clientHeight;
            canvas.width = cityWidth;
            canvas.height = cityHeight;
            initMap();
        }

        function initMap() {
            mapData = [];
            for(let r=0; r<gridRows; r++) {
                for(let c=0; c<gridCols; c++) {
                    // Perlin-ish noise generation for building heights
                    const dist = Math.sqrt((r-7)*(r-7) + (c-7)*(c-7));
                    const baseHeight = Math.max(0, 10 - dist) * Math.random(); 
                    
                    mapData.push({
                        r, c,
                        h: baseHeight * 15, // Height multiplier
                        targetH: baseHeight * 15,
                        color: Math.random() > 0.8 ? '#00f0ff' : (Math.random() > 0.9 ? '#7000ff' : '#222')
                    });
                }
            }
        }

        function drawIsoCube(x, y, w, h, color, height) {
            // Isometric math
            // Top Face
            ctx.beginPath();
            ctx.moveTo(x, y - height);
            ctx.lineTo(x + w, y - h - height);
            ctx.lineTo(x, y - h * 2 - height);
            ctx.lineTo(x - w, y - h - height);
            ctx.closePath();
            
            // Color logic
            if(color === '#222') {
                ctx.fillStyle = 'rgba(255,255,255,0.05)';
            } else {
                ctx.fillStyle = color;
                ctx.shadowBlur = 15;
                ctx.shadowColor = color;
            }
            ctx.fill();
            ctx.shadowBlur = 0; // Reset shadow

            // Right Face
            ctx.beginPath();
            ctx.moveTo(x + w, y - h - height);
            ctx.lineTo(x, y - height);
            ctx.lineTo(x, y);
            ctx.lineTo(x + w, y - h);
            ctx.closePath();
            ctx.fillStyle = color === '#222' ? '#111' : shadeColor(color, -20);
            ctx.fill();

            // Left Face
            ctx.beginPath();
            ctx.moveTo(x - w, y - h - height);
            ctx.lineTo(x, y - height);
            ctx.lineTo(x, y);
            ctx.lineTo(x - w, y - h);
            ctx.closePath();
            ctx.fillStyle = color === '#222' ? '#0a0a0a' : shadeColor(color, -40);
            ctx.fill();
        }

        // Helper to darken colors for shading
        function shadeColor(color, percent) {
            // Simple hex shading would go here, returning placeholder for brevity
            // In a real app, parse Hex to RGB and darken
            return color; 
        }

        function renderCity() {
            ctx.clearRect(0, 0, cityWidth, cityHeight);
            
            // Center the grid
            const centerX = cityWidth / 2;
            const centerY = cityHeight / 2 + 50;

            mapData.forEach(tile => {
                // Cartesian to Isometric
                const isoX = (tile.c - tile.r) * tileW + centerX;
                const isoY = (tile.c + tile.r) * tileH + centerY;
                
                // Animate height with sine wave for "breathing" city
                const animHeight = tile.h + Math.sin(time + tile.c * 0.5) * 5;

                drawIsoCube(isoX, isoY, tileW, tileH, tile.color, Math.max(0, animHeight));
            });
            
            time += 0.05;
            requestAnimationFrame(renderCity);
        }

        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();
        renderCity(); // Start Loop


        // --- 6. TERMINAL LOGIC ---
        const terminalLogs = document.getElementById('terminal-logs');
        const logMessages = [
            "Fetching repo data...",
            "Analyzing commit history...",
            "Optimizing assets...",
            "Connection established: 12ms",
            "Rendering 3D viewport...",
            "User authenticated.",
            "Waiting for input..."
        ];

        let logIndex = 0;
        function addLog() {
            if(logIndex >= logMessages.length) return;
            const div = document.createElement('div');
            div.className = "border-l-2 border-gray-800 pl-2";
            div.innerHTML = `<span class="text-[var(--primary)]">${new Date().toLocaleTimeString()}</span> ${logMessages[logIndex]}`;
            terminalLogs.appendChild(div);
            terminalLogs.scrollTop = terminalLogs.scrollHeight; // Auto scroll
            logIndex++;
            setTimeout(addLog, Math.random() * 1000 + 500);
        }
        
        // Start logs when section is visible
        ScrollTrigger.create({
            trigger: terminalLogs,
            start: "top 80%",
            onEnter: () => addLog()
        });

        // --- 7. COUNTERS ---
        gsap.utils.toArray(".counter").forEach(counter => {
            let target = +counter.getAttribute('data-target');
            ScrollTrigger.create({
                trigger: counter,
                start: "top 85%",
                once: true,
                onEnter: () => {
                    gsap.to(counter, {
                        innerHTML: target,
                        duration: 2.5,
                        snap: { innerHTML: 1 },
                        ease: "power2.out"
                    });
                }
            });
        });

    </script>
</body>
</html>